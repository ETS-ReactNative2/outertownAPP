<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Components/Performance/AllPerformances.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Components/Performance/AllPerformances.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// load dependencies
import React, { useEffect, useState } from 'react';
import { useNavigation } from '@react-navigation/native';
import { ScrollView } from 'react-native-gesture-handler';
import { SafeAreaView } from 'react-native-safe-area-context';
import { SearchBar } from 'react-native-elements';
import Modal from 'react-native-modal';
import AsyncStorage from '@react-native-async-storage/async-storage';
// load components
import Loading from '../Common/Loading';
import Performance from './Performance';
import AllPerformanceHeader from './AllPerformanceHeader';
import HideAllPerformances from './HideAllPerformances';
// load modules
import parsePerformances from '../../Modules/parsePerformances';
import { baseStyles } from '../../Styles/baseStyles';

/**
 * @function AllPerformances : 
 * React Native component for displaying a list of all performances
 * @param {Object} props 
 * @returns {Component}
 */
export default function AllPerformances(props) {
    const [showModal, setShowModal] = useState(props.showAllPerformances);
    const [performances, setPerformances] = useState(false);
    const [allPerformances, setAllPerformances] = useState(false);
    const [search, setSearch] = useState('');
    const [scrollEnabled, setScrollEnabled] = useState(true);
    const [deactivatePressables, setDeactivatePressables] = useState(false);
    const navigation = useNavigation();

    function updateSearch(search) {
        const re = new RegExp(search, 'i');
        setPerformances(allPerformances.filter(performance => {
            return re.test(performance.Band);
        }));
        setSearch(search);
    }

    function swipeCancelled(e) {
        setScrollEnabled(true);
        setDeactivatePressables(false);
        props.setShowAllPerformances(true);
        setShowModal(true);
    }

    const toggleModal = () => {
        setScrollEnabled(true);
        setDeactivatePressables(false);
        props.setShowAllPerformances(false);
        setShowModal(false);
    };

    useEffect(() => {
        (async() => {
            // get venue data from local storage
            // TODO filter performances to only those whose end time is after now
            let localPerformancesData = await AsyncStorage.getItem('@performancesData');
            localPerformancesData = parsePerformances(localPerformancesData);
            setPerformances(localPerformancesData);
            setAllPerformances(localPerformancesData);
        })();
    }, []);

    useEffect(() => {
        setShowModal(props.showAllPerformances);
    }, [props.showAllPerformances]);
    
    // build schedule
    let performanceSchedule;
    if (!performances)
        return &lt;Loading />;
    else if (performances.length === 0) {
        performanceSchedule = &lt;Performance
            performance={{
                Band: 'No bands fit the search',
                Stage: '',
                StartSting: '',
                EndString: '',
            }}
            toggleModal={null}
            key={1}
        />
    } else {
        performanceSchedule = performances.map((performance)=>&lt;Performance
                navigation={navigation}
                performance={performance}
                toggleModal={toggleModal}
                key={performance.Id}
                deactivatePressables={deactivatePressables}
            />)
    }
    return (
        &lt;Modal
            isVisible={showModal}
            animationIn={'slideInRight'}
            animationOut={'slideOutRight'}
            swipeDirection='right'
            onSwipeStart={()=>{
                setScrollEnabled(false);
                setDeactivatePressables(true);
            }}
            onSwipeCancel={swipeCancelled}
            onSwipeComplete={toggleModal}
            swipeThreshold={155}
            backdropColor='#eeeeee'
            backdropOpacity={0.9}
            onBackButtonPress={toggleModal}
            style={{zIndex: 1}}
            accessibilityActions={[{ name: 'activate', label: 'View or hide full gig schedule' }]}
            onAccessibilityAction={({ nativeEvent }) => {
                if (nativeEvent.actionName === 'activate') {
                    setShowAllPerformances(!props.showAllPerformances)
                    setShowModal(!showModal)
                }
            }}
        >
            &lt;ScrollView
                contentContainerStyle={{zIndex:0}}
                scrollEnabled={scrollEnabled}
            >
                &lt;SafeAreaView>
                    &lt;SearchBar
                        placeholder='Search bands...'
                        onChangeText={updateSearch}
                        value={search}
                        containerStyle={{backgroundColor: 'transparent'}}
                        inputContainerStyle={{backgroundColor: '#ffffff'}}
                        inputStyle={baseStyles.stdText}
                    />
                    &lt;AllPerformanceHeader />
                    {performanceSchedule}
                    &lt;HideAllPerformances
                        toggleModal={toggleModal}
                        deactivatePressables={deactivatePressables}
                    />
                &lt;/SafeAreaView>
            &lt;/ScrollView>
        &lt;/Modal>
    );
  }</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="paths%2520_%2520%250AURL%2520paths%2520used%2520in%2520other%2520scriptsmodule_.html">paths : 
URL paths used in other scripts</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AllPerformanceHeader:ReactNativecomponentfordisplayinganinformationheaderfortheperformancesmodal">AllPerformanceHeader : 
React Native component for displaying an information header for the performances modal</a></li><li><a href="global.html#AllPerformances:ReactNativecomponentfordisplayingalistofallperformances">AllPerformances : 
React Native component for displaying a list of all performances</a></li><li><a href="global.html#BandInfo:ReactNativecomponentforshowinginformationaboutaband">BandInfo :
React Native component for showing information about a band</a></li><li><a href="global.html#getBandInfo:Retrievebandinfofromlocalstorage">getBandInfo : 
Retrieve band info from local storage</a></li><li><a href="global.html#getBandPerformance:Retrieveperformance(s)byabandfromlocalstorage">getBandPerformance : 
Retrieve performance(s) by a band from local storage</a></li><li><a href="global.html#getLiked:Retrievelikedstatusofbandfromlocalstorage">getLiked : 
Retrieve liked status of band from local storage</a></li><li><a href="global.html#handleLike:Setsupnotificationsandfeedbackonabandlikedbyauser">handleLike : 
Sets up notifications and feedback on a band liked by a user</a></li><li><a href="global.html#handleSwipe:Opensmodalwhenleftscreenswipedetectedhttps://dev.to/nrymarz/creating-a-tinder-style-swiping-component-with-react-native-part-1-2-h45">handleSwipe : 
Opens modal when left screen swipe detected
https://dev.to/nrymarz/creating-a-tinder-style-swiping-component-with-react-native-part-1-2-h45</a></li><li><a href="global.html#HideAllPerformances:ReactNativecomponentfordisplayingabuttontoclosetheperformancesmodal">HideAllPerformances : 
React Native component for displaying a button to close the performances modal</a></li><li><a href="global.html#HomeScreen:ReactNativecomponenttodisplayapplicationhomescreen">HomeScreen : 
React Native component to display application home screen</a></li><li><a href="global.html#ItemLoading:ReactNativecomponentfordisplayinganimatedscreenwhiledataisloadingasynchronously">ItemLoading : 
React Native component for displaying animated screen while data is loading asynchronously</a></li><li><a href="global.html#LinkWrapper:ReactNativecomponentfordisplayingahyperlinkedchilecomponent">LinkWrapper : 
React Native component for displaying a hyperlinked chile component</a></li><li><a href="global.html#Loading:ReactNativecomponentfordisplayinganimatedscreenwhiledataisloadingasynchronously">Loading : 
React Native component for displaying animated screen while data is loading asynchronously</a></li><li><a href="global.html#NoData:ReactNativecomponentfordisplayingcontentwhenthereisnointernetconnectionandnolocallystoreddata">NoData : 
React Native component for displaying content when there is no internet connection and no locally stored data</a></li><li><a href="global.html#OTLogo:ReactNativecomponentfordisplayingfestivallogo">OTLogo : 
React Native component for displaying festival logo</a></li><li><a href="global.html#PageContainer:ReactNativecomponenttoprovideacontainerappropriatetothecurrentpage">PageContainer : 
React Native component to provide a container appropriate to the current page</a></li><li><a href="global.html#parsePerformances:Takesinputjsonstring,parsesitintoobjectforuseincomponents">parsePerformances : 
Takes input json string, parses it into object for use in components</a></li><li><a href="global.html#Performance:ReactNativecomponentfordisplayinginformationaboutaperformance">Performance :
React Native component for displaying information about a performance</a></li><li><a href="global.html#PostShowHome:ReactNativecomponenttodisplaypost-showinformationscreen">PostShowHome : 
React Native component to display post-show information screen</a></li><li><a href="global.html#prepare:Determinesdatasourcesandretrivesdataonappstartup">prepare : 
Determines data sources and retrives data on app startup</a></li><li><a href="global.html#ScreenWrapper:ReactNativecomponentprovidingatemplatewrapperforeachscreen">ScreenWrapper : 
React Native component providing a template wrapper for each screen</a></li><li><a href="global.html#SwipeHeader:ReactNativecomponenttodisplayinformationalscreenheader">SwipeHeader : 
React Native component to display informational screen header</a></li><li><a href="global.html#VenueInfo:ReactNativecomponentfordisplayinginformationaboutavenue">VenueInfo :
React Native component for displaying information about a venue</a></li><li><a href="global.html#VenueList:ReactNativecomponentfordisplayingalistofvenues">VenueList :
React Native component for displaying a list of venues</a></li><li><a href="global.html#VenueTitle:ReactNativecomponentfordisplayingavenuetitleorlogo">VenueTitle :
React Native component for displaying a venue title or logo</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Feb 11 2022 13:20:22 GMT+0000 (Greenwich Mean Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
